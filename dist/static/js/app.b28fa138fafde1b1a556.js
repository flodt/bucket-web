webpackJsonp([1],{EmOQ:function(t,e){},JfaR:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("7+uW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},i=a("VU/8")({name:"App"},s,!1,null,null,null).exports,o=a("/ocq"),l=a("kxiW"),r=a.n(l),c={methods:{logout(t){t.stopPropagation(),r.a.auth().signOut(),this.$router.push({name:"Login"})}},data:()=>({user:null}),created(){r.a.auth().onAuthStateChanged(t=>{this.user=t})}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",[a("div",{staticClass:"nav-wrapper amber darken-2"},[a("router-link",{staticClass:"brand-logo left",attrs:{to:"/",tag:"a"}},[t._v("Bucket")]),t._v(" "),a("ul",{staticClass:"right",attrs:{id:"nav-mobile"}},[a("li",{directives:[{name:"show",rawName:"v-show",value:!t.user,expression:"!user"}]},[a("router-link",{attrs:{to:"/login"}},[t._v("Login")])],1),t._v(" "),a("li",{directives:[{name:"show",rawName:"v-show",value:t.user,expression:"user"}]},[a("router-link",{attrs:{to:"/profile"}},[t._v("Profile")])],1),t._v(" "),a("li",{directives:[{name:"show",rawName:"v-show",value:t.user,expression:"user"}]},[a("a",{on:{click:t.logout}},[t._v("Logout")])])])],1)])},staticRenderFns:[]},d=a("VU/8")(c,u,!1,null,null,null).exports,h=a("Mdkk"),p=(a("EmOQ"),{name:"Login",data:()=>({}),components:{navigation:d},mounted(){let t=h.a.AuthUI.getInstance();t||(t=new h.a.AuthUI(r.a.auth()));var e={signInSuccessUrl:"/",signInOptions:[r.a.auth.GoogleAuthProvider.PROVIDER_ID,r.a.auth.EmailAuthProvider.PROVIDER_ID]};t.start("#firebaseui-auth-container",e)}}),g={render:function(){var t=this.$createElement,e=this._self._c||t;return e("section",[e("navigation"),this._v(" "),e("h5",{staticClass:"center-align"},[this._v("Login")]),this._v(" "),e("section",{attrs:{id:"firebaseui-auth-container"}})],1)},staticRenderFns:[]};var v=a("VU/8")(p,g,!1,function(t){a("cecd")},null,null).exports,f=a("PMNR"),m=a.n(f),_=a("UBQj"),b={data:()=>({user:null}),components:{navigation:d},created(){r.a.auth().onAuthStateChanged(t=>{t&&(this.user=t),this.user||this.$router.push({name:"Login"}),this.updateDownloadCard()})},methods:{onPickUploadFile(){this.$refs.fileInputUpload.click()},onUploadFilePicked(t){const e=t.target.files;if(0===e.length)return;document.getElementById("uploadProgress").style.display="block";const a=r.a.storage().ref().child("buckets").child(this.user.uid);a.listAll().then(function(t){t.items.forEach(function(t){t.delete()})}).then(function(){for(let t=0;t<e.length;t++){const n=e[t];a.child(n.name).put(n).then(function(a){if(t===e.length-1){document.getElementById("uploadProgress").style.display="none",M.toast({html:"Upload finished!"});let t=e.length;document.getElementById("fileCounter").innerHTML=t.toString(10),document.getElementById("downloadFilesFAB").style.display=0===t?"none":"block"}})}}).catch(function(t){alert("An error occurred in file upload!"),console.log(t),document.getElementById("uploadProgress").style.display="none",this.updateDownloadCard()})},onDownloadFiles(){r.a.storage().ref().child("buckets").child(this.user.uid).listAll().then(function(t){let e=new m.a,a=0;t.items.forEach(function(n){n.getDownloadURL().then(function(s){_.getBinaryContent(s,function(s,i){console.log("Zipping fileâ€¦"),console.log(s),e.file(n.name,i,{binary:!0}),++a===t.items.length&&(console.log("Triggering download"),e.generateAsync({type:"blob"}).then(function(t){saveAs(t,"bucket.zip")}))})}).catch(function(t){alert("Download failed!"),console.log(t)})}),M.toast({html:"Download finished!"})})},updateDownloadCard(){r.a.storage().ref().child("buckets").child(this.user.uid).listAll().then(function(t){let e=t.items.length;document.getElementById("fileCounter").innerHTML=e.toString(10),document.getElementById("downloadFilesFAB").style.display=0===e?"none":"block"})}}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("navigation"),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col s12 m3"},[a("div",{staticClass:"card",staticStyle:{"max-width":"400px"}},[a("div",{staticClass:"card-image"},[a("img",{attrs:{src:"static/card_bucket_empty.png"}}),t._v(" "),a("a",{staticClass:"btn-floating btn-large halfway-fab waves-effect waves-light red",on:{click:t.onPickUploadFile}},[a("i",{staticClass:"material-icons"},[t._v("file_upload")])])]),t._v(" "),a("div",{staticClass:"card-content"},[a("span",{staticClass:"card-title"},[t._v("Upload")]),t._v(" "),a("p",[t._v("Upload files to your Bucket to share them with your other devices!")]),t._v(" "),a("input",{ref:"fileInputUpload",staticStyle:{display:"none"},attrs:{type:"file",accept:"*/*",multiple:""},on:{change:t.onUploadFilePicked}}),t._v(" "),a("br"),t._v(" "),t._m(0)])])]),t._v(" "),a("div",{staticClass:"col s12 m3"},[a("div",{staticClass:"card",staticStyle:{"max-width":"400px"}},[a("div",{staticClass:"card-image"},[a("img",{attrs:{src:"static/card_bucket_full.png"}}),t._v(" "),a("a",{staticClass:"btn-floating btn-large halfway-fab waves-effect waves-light red",staticStyle:{display:"none"},attrs:{id:"downloadFilesFAB"},on:{click:t.onDownloadFiles}},[a("i",{staticClass:"material-icons"},[t._v("file_download")])])]),t._v(" "),t._m(1)])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"progress red",staticStyle:{display:"none"},attrs:{id:"uploadProgress"}},[e("div",{staticClass:"indeterminate",staticStyle:{"background-color":"lightgray"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card-content"},[a("span",{staticClass:"card-title"},[t._v("Download")]),t._v(" "),a("p",[t._v("There are currently "),a("strong",{attrs:{id:"fileCounter"}},[t._v("0")]),t._v(" files in your Bucket.")]),t._v(" "),a("p",[t._v("Download them to this computer!")]),t._v(" "),a("br")])}]};var w=a("VU/8")(b,y,!1,function(t){a("JfaR")},null,null).exports,C={data:()=>({user:null}),components:{navigation:d},created(){r.a.auth().onAuthStateChanged(t=>{t&&(this.user=t)})},methods:{onDeleteUserAccount(){let t=r.a.auth().currentUser;r.a.storage().ref().child("buckets").child(t.uid).listAll().then(function(e){0!==e.items.length?(alert("Your bucket is not empty! Clear it first, then try deleting again."),e.items.forEach(function(t){t.delete().then(function(t){})})):t.delete().then(function(){M.toast({html:"Deleted account successfully!"})}).catch(function(t){alert("An error occurred while deleting the account. Try logging out and logging back in!"),console.log(t)})})},onClearBucket(){r.a.storage().ref().child("buckets").child(this.user.uid).listAll().then(function(t){t.items.forEach(function(t){t.delete()}),M.toast({html:"Bucket cleared!"})}).catch(function(t){alert("Could not clear the bucket."),console.log(t)})}}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("navigation"),t._v(" "),a("h5",{staticClass:"center-align"},[t._v("Profile")]),t._v(" "),t.user?a("div",{staticClass:"card horizontal",staticStyle:{"max-width":"400px",margin:"0 auto"}},[a("div",{staticClass:"card-image",staticStyle:{"margin-top":"25px","margin-left":"10px"}},[a("img",{staticStyle:{width:"75px",height:"75px","border-radius":"50%",border:"4px solid #333"},attrs:{src:t.user.photoURL}})]),t._v(" "),a("div",{staticClass:"card-stacked"},[a("div",{staticClass:"card-content"},[a("p",[t._v(" name: "),a("strong",[t._v(t._s(null==t.user.displayName?"None":t.user.displayName))]),a("br"),t._v("email:\n                    "),a("strong",[t._v(t._s(t.user.email))]),a("br"),t._v("uid:\n                    "),a("strong",[t._v(t._s(t.user.uid))]),t._v(" "),a("br"),t._v("provider: "),a("strong",{staticClass:"teal-text"},[t._v(t._s(t.user.providerData[0].providerId))])]),t._v(" "),a("br"),t._v(" "),a("p",[a("a",{staticClass:"waves-effect waves-light btn grey",on:{click:t.onClearBucket}},[a("i",{staticClass:"material-icons left"},[t._v("clear_all")]),t._v("\n                    Clear bucket\n                ")])]),t._v(" "),a("br"),t._v(" "),a("p",[a("a",{staticClass:"waves-effect waves-light btn red",on:{click:t.onDeleteUserAccount}},[a("i",{staticClass:"material-icons left"},[t._v("delete")]),t._v("\n                    Delete account\n                ")])])])])]):t._e()],1)},staticRenderFns:[]},A=a("VU/8")(C,k,!1,null,null,null).exports;n.a.use(o.a);let U=new o.a({mode:"history",routes:[{path:"/profile",name:"Profile",component:A,meta:{auth:!0}},{path:"/login",name:"Login",component:v,meta:{guest:!0}},{path:"/",name:"Home",component:w}]});U.beforeEach((t,e,a)=>{t.matched.some(t=>t.meta.auth)?r.a.auth().onAuthStateChanged(t=>{t?a():a({path:"/login"})}):t.matched.some(t=>t.meta.guest)?r.a.auth().onAuthStateChanged(t=>{t?a({path:"/profile"}):a()}):a()});var E=U;r.a.initializeApp({apiKey:"AIzaSyB8xfqT3jUpY51Tb7pXG8Gt5PtVG4nJdRg",authDomain:"bucket-47f81.firebaseapp.com",databaseURL:"https://bucket-47f81.firebaseio.com",projectId:"bucket-47f81",storageBucket:"bucket-47f81.appspot.com",messagingSenderId:"1005126071806",appId:"1:1005126071806:web:53a039fb939ae686913caf",measurementId:"G-DGC9R1S4R4"}),n.a.config.productionTip=!1,new n.a({el:"#app",router:E,components:{App:i},template:"<App/>"})},cecd:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.b28fa138fafde1b1a556.js.map